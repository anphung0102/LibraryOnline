
@{
    var user = Session["username"];
    if (Session["username"] == null || Session["user_id"] == null)
    {
        Response.Redirect("~/Login/Index");
    }
    if (Session["role_id"].ToString() == "1")
    {
        Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
    }
    if (Session["role_id"].ToString() == "1")
    {
        Layout = "~/Views/Shared/_LayoutLecturer.cshtml";
    }
    if (Session["role_id"].ToString() == "3")
    {
        Layout = "~/Views/Shared/_LayoutStudent.cshtml";
    }

}
@*<link href="~/Scripts/rateit.css" rel="stylesheet" type="text/css">
    <script src="~/Scripts/jquery.rateit.js"></script>
    <script src="~/Scripts/jquery.rateit.min.js"></script>
    <link href="~/Scripts/jquery-3.3.1.slim.min.map" rel="stylesheet" type="text/css">*@
<!-- Page Content -->
<div class="container">

    <div class="row">
        <div class="col-lg-12">

            <div id="carouselExampleIndicators" class="carousel slide my-4" data-ride="carousel" style="width:1140px;">
                <ol class="carousel-indicators">
                    <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                    <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                </ol>
                <div class="carousel-inner" role="listbox">
                    <div class="carousel-item active">
                        <img class="d-block img-fluid" src="http://placehold.it/1140x350" alt="First slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block img-fluid" src="http://placehold.it/900x350" alt="Second slide">
                    </div>
                    <div class="carousel-item">
                        <img class="d-block img-fluid" src="http://placehold.it/900x350" alt="Third slide">
                    </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
            <!--          tạo các tab liên quan-->
            <div id="navigation">
                <ul class="breadcrumb">
                    <li class="breadcrumb-item"><a href="#">Home</a></li>
                    <li class="breadcrumb-item"><a href="#">Ebooks</a></li>
                    <li class="breadcrumb-item active">Product</li>
                </ul>
            </div><!-- navigation -->
            @*<h1 class="khoangcachduoi">Products</h1>*@
            <div class="row" id="detail">
            </div>
            <div class='col-lg-12 col-md-6 mb-4'>
                <div class='border'>
                    <div class="row" id='info_details'>
                        <div class='col-lg-6'>
                            <div>Đánh giá:</div>
                            <div class="rateit" id="rateit_star1" data-productid="123"></div>
                            <button id="btnRate">Gửi</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- /.col-lg-9 -->

    </div>
    <!-- /.row -->
</div>
<!-- /.container -->
<!-- Footer -->

<script>
    $(document).ready(function () {
        $("#btnRate").click(function () {

            var a = $('#rateit_star1').rateit('value');
            alert(a);
        });
    });
</script>
<script>
    $("#upload").click(function () {

        var ebook = {};
        ebook.title = $("#title").val(); //get từ textbox
        ebook.describe = $("#describe").val(); //get từ text boxt
        ebook.year = $("#year").val(); //get từ textbox
        ebook.user_id = $("#user_id").val(); //get từ text boxt
        ebook.filename = $("#filename").val(); //get từ text boxt
        $.ajax({
            type: "POST",
            url: "/api/FileAPI/UploadEbook",
            data: JSON.stringify(ebook),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (result) {

            }
        });
    });
     // load data
    $(document).ready(function () {

        $.ajax({
            type: "GET",
            url: "/api/FileAPI/GetFileById",
            data: {id:@ViewBag.Id},
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (v) {
                console.log(v);

               var data = "<div class='col-lg-12 col-md-6 mb-4' >";
                data += "<div class='border'>";
                data += "<div class='row' id='info_details'>";
                data += "<div class='col-lg-6'>";
                data += "<h2>" + v.title + "</h2>";
                data += "<p>Tác giả: " + v.author + "</p>";
                data += "<p>Năm xuất bản: " + v.year + "</p>";

                data += "<div id='button_details'>";
                //data += "<embed src='/Content/Upload/" + v.filename + "' type='application/pdf' height='300px' width='100%' class='responsive'>";
                data += "<p id='pdf-link' hidden='hidden'>/Content/Upload/" + v.filename+"</p>";
                //data += "<button style='width: 100px;' id='read' ><a href='/Content/Upload/" + v.filename + "'></a>đọc</button>";
                //data += "<button style='width: 100px;' id='read' >đọc</button>";
                data += "<button style='width: 100px;'><a href='/ReadFileDetails/Index?id=" + v.id + "'" + "data-bind='text:title'>đọc</a></button>";
                //data += '<a href="/Content/Upload/' + v.filename + '" download></a > ';
                data += `<a href="/Content/Upload/${v.filename}" >
                    <input type="button" value="Download" /></a >`

                data += " </div></div>";
                data += "<div class='col-lg-6'><h2>Mô tả:</h2>";
                data += "<p>" + v.describe + "</p>";
                data += "</div ></div ></div ></div > ";
                $("#detail").append(data);

            }
        });
    });


    function openPDF(link) {
        //alert(link);
        if (link) {
            window.open(link);
        }
    }

    $("body").on('click','#read',function () {
        openPDF($('#pdf-link').text());
    });

</script>